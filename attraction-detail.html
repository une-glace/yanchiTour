<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>景点详情 - 盐池旅游导览</title>
  <link rel="stylesheet" href="style.css">
</head>
<body>
  <header class="site-header">
    <div class="site-title">
      <span class="site-title-main" id="page-title-main">景点详情</span>
      <span class="site-title-sub" id="page-title-sub">盐池及周边示例景点介绍</span>
    </div>
  </header>

  <main>
    <section class="breadcrumbs">
      <a href="index.html">首页</a>
      <span class="breadcrumbs-sep">/</span>
      <a href="attractions.html">景点</a>
      <span class="breadcrumbs-sep">/</span>
      <span id="breadcrumbs-current">详情</span>
    </section>

    <section class="detail-hero">
      <div class="detail-carousel">
        <div class="detail-image-wrapper">
          <img id="detail-hero-image" src="" alt="景点图片">
          <div class="detail-hero-overlay">
            <h1 id="detail-name">景点名称</h1>
            <div class="detail-location" id="detail-location">位置</div>
          </div>
          <button class="carousel-arrow carousel-arrow-left" id="detail-prev" type="button">&#8249;</button>
          <button class="carousel-arrow carousel-arrow-right" id="detail-next" type="button">&#8250;</button>
        </div>
        <div class="detail-dots" id="detail-dots"></div>
      </div>
    </section>

    <section class="detail-content">
      <div class="detail-section">
        <h2>概览</h2>
        <p id="detail-overview"></p>
      </div>
      <div class="detail-section">
        <h2>历史与人文</h2>
        <p id="detail-history"></p>
      </div>
      <div class="detail-section">
        <h2>地理位置与环境</h2>
        <p id="detail-geo"></p>
      </div>
      <div class="detail-section">
        <h2>特色体验与特产</h2>
        <p id="detail-feature"></p>
      </div>
    </section>

    <section class="reviews-section">
      <div class="reviews-container">
        <h2>游客评价</h2>
        
        <!-- 评价表单 -->
        <div class="review-form">
          <h3>添加您的评价</h3>
          <form id="review-form">
            <div class="form-group">
              <label for="review-name">您的昵称</label>
              <input type="text" id="review-name" required placeholder="请输入您的昵称">
            </div>
            <div class="form-group">
              <label for="review-rating">评分</label>
              <div class="rating-input">
                <input type="radio" id="rating-5" name="rating" value="5" required>
                <label for="rating-5">★</label>
                <input type="radio" id="rating-4" name="rating" value="4">
                <label for="rating-4">★</label>
                <input type="radio" id="rating-3" name="rating" value="3">
                <label for="rating-3">★</label>
                <input type="radio" id="rating-2" name="rating" value="2">
                <label for="rating-2">★</label>
                <input type="radio" id="rating-1" name="rating" value="1">
                <label for="rating-1">★</label>
              </div>
            </div>
            <div class="form-group">
              <label for="review-comment">评价内容</label>
              <textarea id="review-comment" rows="4" required placeholder="请分享您的体验..."></textarea>
            </div>
            <button type="submit" class="submit-review-btn">提交评价</button>
          </form>
        </div>
        
        <!-- 评价列表 -->
        <div class="reviews-list" id="reviews-list">
          <h3>评价列表</h3>
          <div class="no-reviews" id="no-reviews">
            暂无评价，快来添加第一条评价吧！
          </div>
          <!-- 评价将通过JavaScript动态添加 -->
        </div>
      </div>
    </section>
  </main>

  <footer class="site-footer">
    <div>盐池旅游导览</div>
  </footer>

  <script>
    const header = document.querySelector(".site-header");
    let lastScrollY = window.scrollY;

    window.addEventListener("scroll", () => {
      const currentY = window.scrollY;
      const delta = currentY - lastScrollY;

      if (currentY > 80 && delta > 0) {
        header.classList.add("site-header--hidden");
      } else if (delta < 0 || currentY <= 80) {
        header.classList.remove("site-header--hidden");
      }

      lastScrollY = currentY;
    });

    const detailData = {
      "yanchi-habahulake": {
        name: "哈巴湖湿地公园",
        location: "哈巴湖景区",
        overview: "哈巴湖周边水面与草甸相互交织，水鸟成群停歇，其间点缀着芦苇与野花，是盐池极具代表性的湿地景观。",
        history: "随着生态保护力度的提升，这片湿地逐渐恢复生机，成为当地生态修复与观鸟活动的重要示范区域。",
        geo: "景区位于盐池县境内开阔地带，湖泊以自然降水与地表径流补给，湿地植被丰富，为多种候鸟提供了栖息地。",
        feature: "可以沿着栈道漫步，近距离观察水鸟与水草，也可以在观景台远眺整片湖区，是摄影和研学活动的热门地点。",
        images: [
          "picture/哈巴湖湿地公园/哈巴湖1.jfif",
          "picture/哈巴湖湿地公园/哈巴湖2.jfif",
          "picture/哈巴湖湿地公园/哈巴湖3.png"
        ]
      },
      "yanchi-greatwall": {
        name: "盐池长城遗址群",
        location: "盐池县境内长城沿线",
        overview: "盐池境内保留着隋长城与明长城等多段遗址，墙体、烽火台与关隘遗迹依山势起伏分布，构成独特的历史景观带。",
        history: "这里曾是古代北方防线的重要节点，不同朝代在此修筑防御体系，见证了边塞地区的战事与交流。",
        geo: "长城按照地形走势修建在山脊与沟壑边缘，部分地段保存较为完整，能够清晰辨认墙体结构与建筑方式。",
        feature: "可以选择登临烽火台远眺，也可以在城墙遗址旁徒步，感受长城与黄土丘陵、草地共同构成的雄浑气质。",
        images: ["picture/盐池长城遗址群/长城遗址1.jfif", "picture/盐池长城遗址群/长城遗址2.jpeg", "picture/盐池长城遗址群/长城遗址3.jpg"]
      },
      "yanchi-yueerquan": {
        name: "月儿泉村河谷",
        location: "月儿泉村一带",
        overview: "月儿泉村坐落在河谷之中，一侧是古堡遗迹与传统村落，一侧是水草丰茂的河滩，形成动静结合的立体景观。",
        history: "依托水源与交通便利条件，这里曾是农耕与商贸往来的节点，古堡与村落格局记录着不同历史时期的生活痕迹。",
        geo: "村落沿河谷展开，地形相对平缓，两侧山坡提供了良好的观景平台，可以俯瞰村庄与水系的整体关系。",
        feature: "适合开展轻装徒步与露营活动，白天可以在河边戏水与拍照，夜晚则能在星空下欣赏古堡轮廓与河谷灯火。",
        images: ["picture/月儿泉村河谷/月儿1.webp", "picture/月儿泉村河谷/月儿2.webp", "picture/月儿泉村河谷/月儿3.webp"]
      },
      "yanchi-redmemorial": {
        name: "盐池革命历史纪念馆",
        location: "县城城区",
        overview: "纪念馆通过实物、照片与多媒体展陈，系统梳理了盐池在中国革命历史中的重要地位与关键事件。",
        history: "作为陕甘宁边区的重要组成部分，盐池在革命战争年代承担了物资供给、人员转运等多重任务，这里也成为铭记那段历史的重要场所。",
        geo: "纪念馆位于县城内，交通便利，是进行红色研学与城市观光时常被安排的一站。",
        feature: "适合团队讲解与自助参观，参观结束后可以在周边街区继续感受当下城市生活与历史记忆的交织。",
        images: [
          "picture/盐池革命历史纪念馆/革命1.jfif",
          "picture/盐池革命历史纪念馆/革命2.jfif",
          "picture/盐池革命历史纪念馆/革命3.jfif",
          "picture/盐池革命历史纪念馆/革命4.jfif"
        ]
      },
      "yanchi-chunxue": {
        name: "春雪文化产业园",
        location: "盐池县东顺工业园区",
        overview: "集非遗传承、乡村旅游与产业融合发展的综合性园区，2013年成立后从荞麦壳制品加工拓展至文化旅游领域，2021年入选《全国农村创业园区（基地）目录》，年底获批AA级旅游景区资质。",
        history: "园区历经业务转型，从单一的荞麦壳制品加工发展成为集非遗工艺品生产、文化展馆运营、乡村旅游开发于一体的综合性园区，通过公司+基地+农户模式带动就业增收。",
        geo: "园区位于盐池县东顺工业园区，配套游客服务中心、停车场等完善设施，周边交通便利，环境整洁有序，适合开展各类旅游活动。",
        feature: "可以参观枕头文化馆、滩羊皮工艺美术馆等主题展馆，系统了解荞麦壳养生文化及非遗技艺演变历程，体验研学教育、农事体验等旅游项目，日均接待能力达200人次，年接待游客超5万人次。",
        images: ["picture/春雪文化产业园/春雪1.jfif", "picture/春雪文化产业园/春雪2.jfif", "picture/春雪文化产业园/春雪3.jfif"]
      },
      "yanchi-cultural": {
        name: "盐池县文化馆",
        location: "盐池县城",
        overview: "承担公共文化服务职能的县级文化设施，2021年11月被纳入全国一级文化馆公示名单，通过组织文艺展演、非遗传承、免费培训等活动满足群众文化需求。",
        history: "作为文旅融合重要节点，该馆与图书馆组成的建筑群融合现代设计与历史文脉，配套建设九曲民俗文化园等文旅项目。2022年财政拨款运行经费123.37万元，免费开放配套资金投入8万元保障场馆运行。",
        geo: "位于盐池县城中心区域，交通便利，与图书馆组成现代化建筑群，是盐池县公共文化服务的重要场所。",
        feature: "创编的广场舞《扬鞭再创新辉煌》入围第十九届群星奖决赛，并在2024年承办非遗过大年等系列活动。2025年推行非遗育苗行动，在第五中学等试点校建立非遗社团+课后服务模式，组建10余名传承人教学团队。",
        images: ["picture/盐池县文化馆/文化馆1.jfif", "picture/盐池县文化馆/文化馆2.jfif", "picture/盐池县文化馆/文化馆3.jfif"]
      },
      "yanchi-greatwall-museum": {
        name: "长城关博物馆",
        location: "盐池县盐州古城4A旅游景区",
        overview: "以长城为主题内容的专题性博物馆，坐落于中国万里长城中唯一以'长城'而命名的关隘长城关脚下，现有东西两个展厅共4200平方米，2019年8月建成投入使用。",
        history: "长城关坐落在盐池县城北门外六十步的深沟高垒上，为襟喉总要，是明嘉靖九年（公元1530年）副使齐之鸾，根据三边总制、兵部尚书王琼的授意修筑的。因其直接坐落在长城之上，故以长城命名，是天下唯一坐落在长城上且以长城命名的关隘。",
        geo: "位于宁夏回族自治区盐池县盐州古城4A旅游景区内，地理位置优越，周边环境优美，交通便利，是盐池县重要的文化旅游景点。",
        feature: "旨在挖掘长城深厚的文化内涵，保护文物，传承与弘扬不到长城非好汉精神。陈展手段更多采用声、光、电等最新高科技技术，既有场景和人物绘画，又有互动式体验，且陈展图片丰富，文物等级高。",
        images: ["picture/长城关博物馆/长城关1.jfif", "picture/长城关博物馆/长城关2.jfif", "picture/长城关博物馆/长城关3.jfif"]
      },
      "yanchi-zhangjiachang": {
        name: "张家场博物馆",
        location: "宁夏盐池县",
        overview: "盐池县张家场博物馆位于宁夏盐池县，2013年为保护张家场古城遗址而建，2021年正式开馆。该馆与宁夏文物考古研究所、北京大学考古文博学院合作设立考古研究基地，截至2020年9月已累计开展教育活动192次。馆内现有藏品1201件/套，其中珍贵文物146件/套，展览内容涵盖秦汉时期宁夏古城文化、昫衍县历史及民风民俗。",
        history: "2013年建成张家场汉代专题博物馆，2024年配套数字化体验项目实现文物活态展示。2023年博物馆成立宁夏首支长城保护志愿巡护队，形成全民参与的保护网络。",
        geo: "位于宁夏盐池县，为保护张家场古城遗址而建，与宁夏文物考古研究所、北京大学考古文博学院合作设立考古研究基地。",
        feature: "馆内展览分为三部分：秦汉时期宁夏古城文化、昫衍县历史考据、秦汉民风民俗展示。馆藏文物达1201件/套，其中包含建筑构件、陶器、铜钱等考古出土实物。2024年配套数字化体验项目实现文物活态展示，让历史文物'活'起来。",
        images: ["picture/张家场博物馆/张家场1.jfif", "picture/张家场博物馆/张家场2.jfif", "picture/张家场博物馆/张家场3.jfif"]
      }
    };

    function getQueryId() {
      const params = new URLSearchParams(window.location.search);
      return params.get("id");
    }

    function getImageUrl(seed) {
      if (seed.startsWith("picture/")) {
        return seed;
      }
      return "https://picsum.photos/960/540?random=" + encodeURIComponent("yanchi-" + seed);
    }

    const heroImage = document.getElementById("detail-hero-image");
    const dotsContainer = document.getElementById("detail-dots");
    const detailPrev = document.getElementById("detail-prev");
    const detailNext = document.getElementById("detail-next");
    const nameEl = document.getElementById("detail-name");
    const locationEl = document.getElementById("detail-location");
    const pageTitleMain = document.getElementById("page-title-main");
    const pageTitleSub = document.getElementById("page-title-sub");
    const breadcrumbsCurrent = document.getElementById("breadcrumbs-current");
    const overviewEl = document.getElementById("detail-overview");
    const historyEl = document.getElementById("detail-history");
    const geoEl = document.getElementById("detail-geo");
    const featureEl = document.getElementById("detail-feature");

    let currentImages = [];
    let currentImageIndex = 0;
    let detailTimer = null;

    function buildDots() {
      dotsContainer.innerHTML = "";
      currentImages.forEach((_, index) => {
        const dot = document.createElement("button");
        dot.className = "detail-dot";
        dot.type = "button";
        dot.addEventListener("click", () => {
          currentImageIndex = index;
          updateHeroImage();
          resetDetailTimer();
        });
        dotsContainer.appendChild(dot);
      });
    }

    function updateHeroImage() {
      const seed = currentImages[currentImageIndex];
      heroImage.src = getImageUrl(seed);
      Array.from(dotsContainer.children).forEach((dot, index) => {
        if (index === currentImageIndex) {
          dot.classList.add("active");
        } else {
          dot.classList.remove("active");
        }
      });
    }

    function startDetailTimer() {
      detailTimer = setInterval(() => {
        currentImageIndex = (currentImageIndex + 1) % currentImages.length;
        updateHeroImage();
      }, 5000);
    }

    function resetDetailTimer() {
      if (detailTimer) {
        clearInterval(detailTimer);
      }
      startDetailTimer();
    }

    detailPrev.addEventListener("click", () => {
      if (!currentImages.length) return;
      currentImageIndex = (currentImageIndex - 1 + currentImages.length) % currentImages.length;
      updateHeroImage();
      resetDetailTimer();
    });

    detailNext.addEventListener("click", () => {
      if (!currentImages.length) return;
      currentImageIndex = (currentImageIndex + 1) % currentImages.length;
      updateHeroImage();
      resetDetailTimer();
    });

    function renderDetail() {
      const id = getQueryId();
      const data = detailData[id] || detailData["yanchi-habahulake"];
      nameEl.textContent = data.name;
      locationEl.textContent = data.location;
      pageTitleMain.textContent = data.name;
      pageTitleSub.textContent = "盐池及周边景点详细介绍示例";
      breadcrumbsCurrent.textContent = data.name;
      overviewEl.textContent = data.overview;
      historyEl.textContent = data.history;
      geoEl.textContent = data.geo;
      featureEl.textContent = data.feature;

      currentImages = data.images.slice();
      currentImageIndex = 0;
      buildDots();
      updateHeroImage();
      startDetailTimer();
    }

    renderDetail();

    // 评价功能
    const reviewForm = document.getElementById('review-form');
    const reviewsList = document.getElementById('reviews-list');
    const noReviews = document.getElementById('no-reviews');

    // 获取当前景点ID
    const currentAttractionId = getQueryId();

    // 加载评价
    function loadReviews() {
      try {
        const reviews = JSON.parse(localStorage.getItem('attractionReviews') || '{}');
        const attractionReviews = reviews[currentAttractionId] || [];
        
        if (attractionReviews.length === 0) {
          noReviews.style.display = 'block';
          return;
        }
        
        noReviews.style.display = 'none';
        
        // 清空现有评价
        while (reviewsList.children.length > 1) { // 保留h3标题
          reviewsList.removeChild(reviewsList.lastChild);
        }
        
        // 按时间倒序排列
        attractionReviews.sort((a, b) => new Date(b.timestamp) - new Date(a.timestamp));
        
        // 显示评价
        attractionReviews.forEach(review => {
          const reviewItem = document.createElement('div');
          reviewItem.className = 'review-item';
          
          const reviewHeader = document.createElement('div');
          reviewHeader.className = 'review-header';
          
          const reviewName = document.createElement('span');
          reviewName.className = 'review-name';
          reviewName.textContent = review.name;
          
          const reviewRating = document.createElement('div');
          reviewRating.className = 'review-rating';
          for (let i = 0; i < 5; i++) {
            const star = document.createElement('span');
            star.className = 'star';
            star.textContent = '★';
            star.style.color = i < review.rating ? '#ffd700' : '#ddd';
            reviewRating.appendChild(star);
          }
          
          const reviewDate = document.createElement('span');
          reviewDate.className = 'review-date';
          reviewDate.textContent = new Date(review.timestamp).toLocaleString('zh-CN');
          
          const reviewComment = document.createElement('div');
          reviewComment.className = 'review-comment';
          reviewComment.textContent = review.comment;
          
          reviewHeader.appendChild(reviewName);
          reviewHeader.appendChild(reviewRating);
          reviewHeader.appendChild(reviewDate);
          
          reviewItem.appendChild(reviewHeader);
          reviewItem.appendChild(reviewComment);
          reviewsList.appendChild(reviewItem);
        });
      } catch (error) {
        console.error('加载评价失败:', error);
      }
    }

    // 保存评价
    function saveReview(review) {
      try {
        const reviews = JSON.parse(localStorage.getItem('attractionReviews') || '{}');
        
        if (!reviews[currentAttractionId]) {
          reviews[currentAttractionId] = [];
        }
        
        reviews[currentAttractionId].push(review);
        localStorage.setItem('attractionReviews', JSON.stringify(reviews));
        return true;
      } catch (error) {
        console.error('保存评价失败:', error);
        return false;
      }
    }

    // 提交评价
    if (reviewForm) {
      reviewForm.addEventListener('submit', function(e) {
        e.preventDefault();
        
        const name = document.getElementById('review-name').value;
        const rating = parseInt(document.querySelector('input[name="rating"]:checked').value);
        const comment = document.getElementById('review-comment').value;
        
        const review = {
          id: Date.now().toString(),
          name: name,
          rating: rating,
          comment: comment,
          timestamp: new Date().toISOString()
        };
        
        if (saveReview(review)) {
          // 重置表单
          reviewForm.reset();
          // 重新加载评价
          loadReviews();
          // 显示成功消息
          alert('评价提交成功！');
        } else {
          alert('评价提交失败，请重试。');
        }
      });
    }

    // 初始加载评价
    loadReviews();
  </script>
</body>
</html>
